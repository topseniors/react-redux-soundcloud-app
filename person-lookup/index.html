<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mike Sprague">
    <title></title>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/superhero/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css">
    <style>
      * {
        text-rendering: optimizeLegibility;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }
      html {
        position: relative;
        min-height: 100%;
      }
      body {
        margin-bottom: 60px;
        font-family: -apple-system, BlinkMacSystemFont,
          "Segoe UI", "Roboto", "Oxygen", "Ubuntu", "Cantarell",
          "Fira Sans", "Droid Sans", "Helvetica Neue",
          sans-serif;
      }

      .people-list {
        margin-top: 20px;
        height: calc(100vh - 250px);
        overflow-y: auto;
      }
      .people-list li.list-group-item {
        cursor: pointer;
      }
      .people-list li:nth-child(odd) {
        background-color: #2b3e50;
      }
      .people-list li.list-group-item:hover {
        background-color: #485563;
      }
      .person-container {
        margin-top: 75px;
      }
      .person-thumbnail {
        border: 6px solid #ebebeb;
        margin-top: 25%;
      }

      .footer {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 60px;
      }
    </style>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.3/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container" id="app">
      <div class="row">
        <div class="col-sm-6"><!-- list -->
          <h1>All People</h1>
          <input class="form-control" placeholder="Filter by name..." type="text" v-model="search" v-show="people">
          <ul class="people-list list-group">
            <li v-if="!people" class="text-center">
              <loading></loading>
            </li>
            <li class="list-group-item" v-for="person in people | filterBy search" @click="selectPerson( person )">
              <person-name :first="person.name.first" :last="person.name.last"></person-name>
            </li>
          </ul>
        </div>
        <div class="col-sm-6"><!-- details -->
          <div v-if="person" class="well row person-container">
            <div class="col-xs-4">
              <img alt="Thumbnail" class="img-circle img-responsive person-thumbnail" :src="person.picture.large">
            </div>
            <div class="col-xs-8">
              <h2><person-name :first="person.name.first" :last="person.name.last"></person-name></h2>
              <ul class="fa-ul">
                <li>
                  <i class="fa-li fa fa-home"></i> {{ person.location.street | titlecase }}
                  <br>
                  {{ person.location.city | titlecase }}, {{ person.location.state | titlecase }} {{ person.location.postcode }}
                </li>
                <li>
                  <i class="fa-li fa fa-envelope"></i> {{ person.email }}
                </li>
                <li>
                  <i class="fa-li fa fa-phone"></i> {{ person.phone }}
                </li>
                <li>
                  <i class="fa-li fa fa-mobile-phone"></i> {{ person.cell }}
                </li>
                <li>
                  <i class="fa-li fa fa-birthday-cake"></i> {{ person.dob | dateonly }}
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>

    <footer class="footer">
      <div class="container">
        <p class="text-muted text-center">
          Built by <a href="https://mikesprague.me" target="_blank">Mike Sprague</a>.
          <br>
          Source <i class="fa fa-code"></i> available on <a href="https://github.com/mikesprague/vuejs-projects/" target="_blank"><i class="fa fa-github"></i> GitHub</a>.
        </p>
      </div>
    </footer>

    <template id="loading">
      <p class="lead text-center">... loading data ...</p>
    </template>

    <template id="person-name">
      <span>{{ first | capitalize }} {{ last | capitalize }}</span>
    </template>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/1.0.26/vue.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/0.9.3/vue-resource.js"></script>
    <script>
      Vue.filter( "titlecase", function( str ) {
        return str.split( " " ).map( function ( item ) {
            return item.charAt( 0 ).toUpperCase() + item.substring( 1 );
        }).join( " " );
      });

      Vue.filter( "dateonly", function ( str ) {
        return str.split( ' ' )[0];
      });

      Vue.component( "person-name", {
        props: [ "first", "last" ],
        template: "#person-name"
      });

      Vue.component( "loading", {
        template: "#loading"
      });

      var personLookup = new Vue({
        el: "#app",
        data: {
          search: "",
          people: null,
          person: null,
          apiUrl: "https://randomuser.me/api/?seed=person-lookup&nat=us&exc=login&results=250"
        },
        created: function() {
          this.getPeople();
        },
        methods: {
          getPeople: function() {
            this.$http.get( this.apiUrl ).then(( response ) => {
                this.people = response.json().results;
            }, ( response ) => {
                console.warn( response );
            });
          },
          selectPerson: function( p ) {
            this.person = p;
          }
        }
      })
    </script>
  </body>
</h3>
